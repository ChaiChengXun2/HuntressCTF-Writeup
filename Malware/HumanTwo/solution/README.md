# CTF Challenge Writeup
**Name:** HumanTwo
**Points:** 50
**Category:** Malware

## Objective

The objective of this challenge was to uncover the flag hidden within a set of HTML documents by analyzing their content.

## Solution

1. **Unzipping the Flag**
   - To begin, I unzipped the flag file using the following command: `unzip human2.aspx_iocs.zip`.

2. **Analyzing Extracted Files**
   - After unzipping, I found numerous HTML documents extracted. The exact number may vary.

3. **Identifying File Types**
   - I used the `file *` command to determine the file types. I discovered that all of them were HTML documents.

4. **Hash Investigation**
   - The challenge description hinted that only one of these files had a different hash compared to the others. I started examining the content of these HTML files.

5. **Comparing Hashes**
   - While inspecting the HTML files, I noticed that all of them compared a variable called 'pass' to a hash using a condition similar to:
     ```javascript
     if (!String.Equals(pass, "1f996e8c-5eb2-4cbb-802c-672560b32cc1"))
     ```
   - This led me to believe that the flag was related to these hashes.

6. **Python Script for Analysis**
   - My first attempt was to write a Python script to automate the analysis. The script consisted of:
     - `readDirectory()`: Reads all the hashes within each HTML file and stores them in a dictionary.

7. **An Anomaly Discovered**
   - Upon running my Python script, I encountered a unique challenge. Although I located an anomaly in one of the hashes, it turned out that this hash was not the direct flag. (Instead, it required further decoding which I have not notice.)

8. **Identifying the Correct File**
   - The next step was to pinpoint the file associated with the differing hash. I used the `findFileName()` function for this purpose.

9. **Flag Remains Elusive**
   - However, even after identifying the file containing the differing hash, I discovered that the flag was not directly associated with the filename.

10. **Decoding the Anomaly**
    - This is where the breakthrough happened. I realized that the hashes appeared to be encoded in hexadecimal format.

11. **Flag Extraction**
    - Armed with this realization, I successfully decoded the anomaly, revealing the flag for this challenge.

12. **Python Script Explanation**
    - The Python script reads the hashes from each HTML file and stores them in a dictionary. It then identifies the differing hash, extracts it, and decodes it to obtain the flag.

13. **Flag**
    - The flag for the HumanTwo challenge is `flag{XXXXXXXXXX}`. I replaced 'XXXXXXXXXX' with the actual flag I obtained after successfully decoding the differing hash from the HTML documents.

        ```
        import os
        
        dictionary = dict()
        deflated_directory = os.path.join(os.getcwd(), "deflated")
        
        def readDirectory():
        	if os.path.exists(deflated_directory) and os.path.isdir(deflated_directory):
        		files = [f for f in os.listdir(deflated_directory) if os.path.isfile(os.path.join(deflated_directory, f))]
        		for path in files:
        			with open(f"{os.getcwd()}/deflated/{path}", "r") as file: 
        				content = file.readlines()
        				code = content[35].strip().replace("if (!String.Equals(pass, \"", "").replace("\")) {", "")
        
        				if code not in dictionary:
        					dictionary[code] = 1
        				else:
        					dictionary[code] += 1
        	else:
        		print("The 'deflated' directory does not exist in the current directory.")
        
        def findFileName():
        	length_of_hash = 36
        	index = 0 
        	for thing in dict.keys(dictionary):
        		if len(thing) != length_of_hash:
        			print(thing)
        			print(f"File Number {index}")
        			break
        		index += 1
        
        	print(f"File Name: {os.listdir(deflated_directory)[index]}")
        
        def getFlag(): 
        	length_of_hash = 36
        	password = ""
        	flag = ""
        	for thing in dict.keys(dictionary):
        		if len(thing) != length_of_hash:
        			password = thing
        			break
        
        	for individual_password in password.split('"+"'):
        		individual_hash = individual_password.split("-")
        		for thing in individual_hash:
        			flag += bytearray.fromhex(thing).decode(errors="ignore")
        
        	print(flag)
        
        readDirectory()
        getFlag()
        ```

Completing this Malware challenge was a true test of my determination and problem-solving skills. My perseverance ultimately paid off, as I successfully decoded the hidden flag, showcasing my tenacity in CTF challenges.
