import os

dictionary = dict()
deflated_directory = os.path.join(os.getcwd(), "deflated")

def readDirectory():
  if os.path.exists(deflated_directory) and os.path.isdir(deflated_directory):
    files = [f for f in os.listdir(deflated_directory) if os.path.isfile(os.path.join(deflated_directory, f))]
    for path in files:
      with open(f"{os.getcwd()}/deflated/{path}", "r") as file: 
        content = file.readlines()
        code = content[35].strip().replace("if (!String.Equals(pass, \"", "").replace("\")) {", "")

        if code not in dictionary:
          dictionary[code] = 1
        else:
          dictionary[code] += 1
  else:
    print("The 'deflated' directory does not exist in the current directory.")

def findFileName():
  length_of_hash = 36
  index = 0 
  for thing in dict.keys(dictionary):
    if len(thing) != length_of_hash:
      print(thing)
      print(f"File Number {index}")
      break
    index += 1

  print(f"File Name: {os.listdir(deflated_directory)[index]}")

def getFlag(): 
  length_of_hash = 36
  password = ""
  flag = ""
  for thing in dict.keys(dictionary):
    if len(thing) != length_of_hash:
      password = thing
      break

  for individual_password in password.split('"+"'):
    individual_hash = individual_password.split("-")
    for thing in individual_hash:
      flag += bytearray.fromhex(thing).decode(errors="ignore")

  print(flag)

readDirectory()
getFlag()