# Hot Off The Press - CTF Challenge Writeup

Challenge: Hot Off The Press
Points: 50
Category: Malware

## Objective
The objective of the Hot Off The Press challenge is to extract hidden information from a ```.uha``` file. Your task is to navigate through the challenge's complexity and uncover the flag.

## Solution
To successfully complete the Hot Off The Press challenge, I followed these steps:

1. **Overcoming Initial Challenges**:
   - The initial setup proved to be more challenging than the actual task ahead.

2. **Understanding the File Format**:
   - I was provided with a ```.uha``` file, a format that requires specific Windows software for decompression.

3. **Windows Machine Consideration**:
   - Initially, I wanted to use my own Windows to solve the challenge as ```.uha``` files are exclusive to windows. However, I encountered issues with Windows Defender removing the file due to suspected malware signatures. Like the challenge suggested, this challenge is based on a real malware, therefore, windows defenders may have picked up the malware signature and removed it automatically. 

4. **Running Windows Executables on Linux**:
   - To circumvent the Windows setup, I explored the option of running Windows executables on Linux. Wine, a compatibility layer for Windows applications on non-Windows systems, proved to be a solution.

5. **Utilizing Wine and uharc**:
   - I downloaded the uharc tool from [this link](https://sam.gleske.net/uharc/).
   - Using Wine, I ran uharc to decompress the ```.uha``` file with the following command:
     ```
     wine uharc -pw e file.uha
     ```

6. **Extracting the Powershell Script**:
   - After decompression, I found a ```.ps1``` file, which essentially is a Powershell script.
   - In the script, I identified a base64 string being constructed using format strings.

7. **Base64 Extraction**:
   - My aim was to extract the base64 encoded within the script. Format strings in Powershell work similarly to those in C and Python.

8. **Decoding with CyberChef**:
   - I utilized CyberChef, specifically its "Magic" tool, to decode the base64 string.
   - The result was another base64-encoded message.

9. **URL Decoding**:
   - I decoded the base64-encoded message using a URL decoder, revealing the final message containing the flag.

10. By following these steps, I successfully obtained the flag hidden within the ```.uha``` file in the Hot Off The Press challenge.

## Flag
The flag for this challenge is in the format: `flag{XXXXXXXXXX}`.

Navigating the complexities of setup and data extraction, you'll uncover the flag in the Hot Off The Press challenge. Best of luck!
